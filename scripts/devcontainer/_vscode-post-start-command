#!/usr/bin/env bash

set -euo pipefail


echo "Copying tree-sitter.so to backend/src/LibTreeSitter"
mv /home/dark/tree-sitter.so /home/dark/app/backend/src/LibTreeSitter/tree-sitter.so


echo "Starting build server"

mkdir -p rundir/logs/

nohup ./scripts/build/_build-server --compile --watch &> /home/dark/app/rundir/logs/build-server.log &

# It seems that if we don't sleep here, the server does not start properly in all cases
sleep 2

echo "Build server started"
