// TODO:
//alias PT = PACKAGE.Darklang.Stdlib.ProgramTypes
//alias RT = PACKAGE.Darklang.Stdlib.RuntimeTypes

module Darklang =
  module PrettyPrinter =
    let indent (s: String) : String =
      s
      |> String.split "\n"
      |> List.map (fun line ->
        match line with
        | "" -> ""
        | line -> "  " ++ line)
      |> String.join "\n"

    let sign (s: PACKAGE.Darklang.Stdlib.Sign) : String =
      match s with
      | Positive -> ""
      | Negative -> "-"

    let escapeSpecialCharacters (s: String) : String =
      s
      |> String.replaceAll "\n" "\\n"
      |> String.replaceAll "\t" "\\t"
      |> String.replaceAll "\r" "\\r"

    let processRemainder (remainder: String) : String =
      let rem = $".{remainder}" |> Float.parse

      match rem with
      | Ok r ->
        if r == 0.0 then
          "0"
        else
          (r |> Float.toString) |> String.dropFirst 2
      | Error e -> e